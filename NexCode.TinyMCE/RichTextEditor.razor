@using Microsoft.JSInterop
@using NexCode.TinyMCE.Blazor.Code

<CascadingValue TValue="RichTextEditor" Value="this" IsFixed="true">
    <CascadingValue TValue="IEditorScope" Value="this" IsFixed="true">
        <CascadingValue TValue="IEditor" Value="Editor">

        @if (!ExcludeDefaultPlugins)
        {
        <DefaultPlugins />
        }
        @if (Plugins != null)
        {

            @Plugins
        }

        @if (Inline)
        {
            <div id="@Id"/>
        }
        else
        {
            <textarea id="@Id"/>
        }
        
        </CascadingValue>
    </CascadingValue>
</CascadingValue>


@code
{

    [JSInvokable]
    public async Task OnChange() =>await UpdateHtml();


    private string _html;

    [Parameter]
    public string Html
    {
        get => _html;
        set
        {
            _html = value;
            if (Editor != null)
                Editor.SetContent(value);
        }
    }
   
    [Parameter] public EventCallback<string> HtmlChanged { get; set; }

    [Parameter]
    public bool Inline { get; set; }

}
