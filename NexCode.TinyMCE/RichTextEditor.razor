@using Microsoft.JSInterop
@using NexCode.TinyMCE.Blazor.Code

<CascadingValue TValue="RichTextEditor" Value="this" IsFixed="true">
    <CascadingValue TValue="IEditorScope" Value="this" IsFixed="true">
        <CascadingValue TValue="IEditor" Value="Editor">

        @if (!ExcludeDefaultPlugins)
        {
        <DefaultPlugins />
        }
        @if (Plugins != null)
        {

            @Plugins
        }

        <textarea id="@Id">
            @Html
        </textarea>
        </CascadingValue>
    </CascadingValue>
</CascadingValue>


@code
{

    [JSInvokable]
    public async Task OnChange() =>await UpdateHtml();

    private string _html = string.Empty;
    [Parameter]
    public string Html
    {
        get => _html;
        set
        {
            if (_html != value && Editor!=null)
            { 
                Editor.SetContent(value);
            }
            _html = value;
        }
    } 
    [Parameter] public EventCallback<string> HtmlChanged { get; set; }

    [Parameter]
    public bool Inline { get; set; }

}
